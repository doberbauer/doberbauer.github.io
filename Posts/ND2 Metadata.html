<h1 id="nd2-metadata">ND2 Metadata</h1>
<p>This morning I was faced with the task of opening 114 microscope
image files, opening up the image properties and jotting down the image
width and height. To make matters worse, the program to open those files
can only be used if you are</p>
<p>A. physically at your computer and have a HASP key plugged in</p>
<p>or</p>
<p>B. using Google Chrome’s remote desktop extension, which is painfully
slow and sometimes just stops working for no apparent reason</p>
<p>I have been dabbling with the <a
href="https://pypi.org/project/nd2/">nd2</a> package to automate some
other tedious tasks like grabbing excitation wavelengths, channel names,
image dimensions and other bits of metadata. I wrote a little script
using this gem of a package to fetch the metadata from every file, index
into it, fetch the properties I want and append them to a list.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>paths <span class="op">=</span> [ <span class="op">&lt;</span>all_the_paths<span class="op">&gt;</span> ] </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> []</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> []</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> paths:</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> nd2.ND2File(path) <span class="co"># load image</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    meta <span class="op">=</span> f.unstructured_metadata()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    width.append(meta[<span class="st">&quot;&quot;</span>ImageAttributesLV<span class="st">&quot;&quot;</span>][<span class="st">&quot;&quot;</span>SLxImageAttributes<span class="st">&quot;&quot;</span>][<span class="st">&quot;&quot;</span>Width<span class="st">&quot;&quot;</span>])</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    height.append(meta[<span class="st">&quot;&quot;</span>ImageAttributesLV<span class="st">&quot;&quot;</span>][<span class="st">&quot;&quot;</span>SLxImageAttributes<span class="st">&quot;&quot;</span>][<span class="st">&quot;&quot;</span>Height<span class="st">&quot;&quot;</span>])</span></code></pre></div>
<p>It took a few minutes to write the script. It took roughly 5 seconds
to run.</p>
<p>Just for fun I timed how long it took to open a single file in the
image viewer program, open up the image properties window and jot down
the metadata. It took 21.26 seconds from start to finish, mostly due to
the dimensions property not being selectable in the program so I
couldn’t just copy/paste I had to type it out. Assuming I was working at
a constant rate it would have taken me 39.9 minutes to get the
dimensions for all 114 files.</p>
<p>The time I saved has been repurposed to write this post.</p>
