<p>I wrote a quick Python script that recreates an image using thousands
of randomly placed squares. The square color is determined by taking the
mean color value of the original image that’s covered by the square.
Square size is randomly determined between a max and a min. To ensure
there aren’t any gaps between boxes the number of boxes is determined
mathematically as the midpoint between the number of boxes needed if all
of them were the max size and if all of them are the min size.</p>
<p>Unsurprisingly, wrecktangles acts as a form of <em>incredibly</em>
lossy compression. Increasing the min and max box sizes increases the
compression ratio.</p>
<p>Original (6.75 MB) <img
src="https://bear-images.sfo2.cdn.digitaloceanspaces.com/hyperific-1706045452-0.jpg"
alt="Hyperific’s blog" /> Wrecktangle min 5, max 20 (4.30 MB) <img
src="https://bear-images.sfo2.cdn.digitaloceanspaces.com/hyperific-1706054626-0.png"
alt="Hyperific’s blog" /> Wrecktangle min 10, max 75 (1.47 MB) <img
src="https://bear-images.sfo2.cdn.digitaloceanspaces.com/hyperific-1706054557-0.png"
alt="Hyperific’s blog" /></p>
<p>For fun I wrote the script using OpenCV and again using PIL. ## <a
href="https://gist.github.com/hyperific/a624df6cb12640ed20b0cc228dc4dbc7">OpenCV
version</a></p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wreck(path,r1,r2):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> cv2.imread(path)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    out <span class="op">=</span> np.zeros(img.shape,dtype<span class="op">=</span>np.uint8)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> img.shape[<span class="dv">1</span>]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> img.shape[<span class="dv">0</span>]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(((w<span class="op">*</span>h <span class="op">/</span> r2) <span class="op">+</span> (w<span class="op">*</span>h <span class="op">/</span> r1)) <span class="op">/</span><span class="dv">2</span>)):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>       boxsize <span class="op">=</span> np.random.randint(r1,r2)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>       x1 <span class="op">=</span> np.random.randint(<span class="dv">0</span>,w<span class="op">-</span>boxsize)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>       x2 <span class="op">=</span> x1<span class="op">+</span>boxsize</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>       y1 <span class="op">=</span> np.random.randint(<span class="dv">0</span>,h<span class="op">-</span>boxsize)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>       y2 <span class="op">=</span> y1<span class="op">+</span> boxsize</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>       mean <span class="op">=</span> (np.mean(img[y1:y2,x1:x2,<span class="dv">0</span>]), np.mean(img[y1:y2,x1:x2,<span class="dv">1</span>]), np.mean(img[y1:y2,x1:x2,<span class="dv">2</span>]))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>       out <span class="op">=</span> cv2.rectangle(out, (x1, y1), (x2, y2), mean, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    cv2.imwrite(<span class="st">&quot;out.png&quot;</span>, out)</span></code></pre></div>
<h2 id="pil-version"><a
href="https://gist.github.com/hyperific/6b8544f8e4bb0ad6af6f78c2e4420fb8">PIL
version</a></h2>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image, ImageDraw</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wreck(path,r1<span class="op">=</span><span class="dv">5</span>, r2<span class="op">=</span><span class="dv">21</span>):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> np.array(Image.<span class="bu">open</span>(path))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    out <span class="op">=</span> Image.new(<span class="st">&#39;RGB&#39;</span>, (img.shape[<span class="dv">1</span>],img.shape[<span class="dv">0</span>]))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    draw <span class="op">=</span> ImageDraw.Draw(out) <span class="co"># Init ImageDraw</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> img.shape[<span class="dv">1</span>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> img.shape[<span class="dv">0</span>]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(((w<span class="op">*</span>h <span class="op">/</span> r2) <span class="op">+</span> (w<span class="op">*</span>h <span class="op">/</span> r1)) <span class="op">/</span><span class="dv">2</span>)):</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>       boxsize <span class="op">=</span> np.random.randint(r1,r2)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>       x1 <span class="op">=</span> np.random.randint(<span class="dv">0</span>,w<span class="op">-</span>boxsize)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>       x2 <span class="op">=</span> x1<span class="op">+</span>boxsize</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>       y1 <span class="op">=</span> np.random.randint(<span class="dv">0</span>,h<span class="op">-</span>boxsize)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>       y2 <span class="op">=</span> y1<span class="op">+</span> boxsize</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>       mean <span class="op">=</span> (<span class="bu">int</span>(np.mean(img[y1:y2,x1:x2,<span class="dv">0</span>])), <span class="bu">int</span>(np.mean(img[y1:y2,x1:x2,<span class="dv">1</span>])), <span class="bu">int</span>(np.mean(img[y1:y2,x1:x2,<span class="dv">2</span>])))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>       draw.rectangle(((x1, y1), (x2, y2)), fill<span class="op">=</span>mean)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    out.save(<span class="st">&quot;out.png&quot;</span>)</span></code></pre></div>
