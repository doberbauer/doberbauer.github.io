<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Daniel Oberbauer">
  <meta name="description" content="Posts and writings by Daniel Oberbauer">


<meta name="keywords" content="">

  <title>
    Daniel Oberbauer
&ndash; ND2 Metadata  </title>

</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="">
        <img src="/theme/images/logo.png" alt="logo">
      </a>
      <h2><a href="">Daniel Oberbauer</a></h2>
      <p></p>
      <ul>
        <li><a href="/category/art.html">Art</a></li>
        <li><a href="/category/exploration.html">Exploration</a></li>
        <li><a href="/category/project.html">Project</a></li>
        <li><a href="/category/resources.html">Resources</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="">Index</a> &brvbar; <a href="/archives.html">Archives</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="/nd2-metadata.html">ND2 Metadata</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 15 September 2023</p>
  </div>
  <div class="article_text">
    <h1>ND2 Metadata</h1>
<p>This morning I was faced with the task of opening 114 microscope image files, opening up the image properties and jotting down the image width and height. 
To make matters worse, the program to open those files can only be used if you are</p>
<p>A. physically at your computer and have a HASP key plugged in</p>
<p>or </p>
<p>B. using Google Chrome's remote desktop extension, which is painfully slow and sometimes just stops working for no apparent reason</p>
<p>I have been dabbling with the <a href="https://pypi.org/project/nd2/">nd2</a> package to automate some other tedious tasks like grabbing excitation wavelengths, channel names, image dimensions and other bits of metadata. I wrote a little script using this gem of a package to fetch the metadata from every file, index into it, fetch the properties I want and append them to a list.</p>
<div class="highlight"><pre><span></span><code><span class="n">paths</span> <span class="o">=</span> <span class="p">[</span> <span class="o">&lt;</span><span class="n">all_the_paths</span><span class="o">&gt;</span> <span class="p">]</span> 
<span class="n">width</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">height</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">nd2</span><span class="o">.</span><span class="n">ND2File</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="c1"># load image</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unstructured_metadata</span><span class="p">()</span>
    <span class="n">width</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="n">ImageAttributesLV</span><span class="s2">&quot;&quot;</span><span class="p">][</span><span class="s2">&quot;&quot;</span><span class="n">SLxImageAttributes</span><span class="s2">&quot;&quot;</span><span class="p">][</span><span class="s2">&quot;&quot;</span><span class="n">Width</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="n">height</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="n">ImageAttributesLV</span><span class="s2">&quot;&quot;</span><span class="p">][</span><span class="s2">&quot;&quot;</span><span class="n">SLxImageAttributes</span><span class="s2">&quot;&quot;</span><span class="p">][</span><span class="s2">&quot;&quot;</span><span class="n">Height</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
</code></pre></div>

<p>It took a few minutes to write the script.
It took roughly 5 seconds to run.</p>
<p>Just for fun I timed how long it took to open a single file in the image viewer program, open up the image properties window and jot down the metadata. It took 21.26 seconds from start to finish, mostly due to the dimensions property not being selectable in the program so I couldn't just copy/paste I had to type it out. Assuming I was working at a constant rate it would have taken me 39.9 minutes to get the dimensions for all 114 files.</p>
<p>The time I saved has been repurposed to write this post. </p>
  </div>
  <div class="article_meta">
    <p>Category: <a href="/category/exploration.html">Exploration</a>
    </p>
  </div>


</article>


    <div id="ending_message">
      <p>&copy; Daniel Oberbauer. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>